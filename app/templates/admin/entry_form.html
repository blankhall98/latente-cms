<!--app/templates/admin/entry_form.html-->
{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <h2 class="mb-3">{{ 'New entry' if mode=='create' else 'Edit entry' }}</h2>

  {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
  {% endif %}

  <form method="post">
    {% if mode == 'create' %}
      <input type="hidden" name="tenant_slug" value="{{ tenant_slug }}"/>
      <input type="hidden" name="section_key" value="{{ section_key }}"/>
    {% endif %}

    <div class="mb-3">
      <label class="form-label">Slug</label>
      <input class="form-control" name="slug" value="{{ initial.slug }}" placeholder="home" required />
    </div>

    <div class="row">
      <div class="col-md-4 mb-3">
        <label class="form-label">Schema version</label>
        <input class="form-control" name="schema_version" type="number" min="1" value="{{ initial.schema_version or 3 }}" required />
      </div>
      <div class="col-md-4 mb-3">
        <label class="form-label">Status</label>
        <select class="form-select" name="status">
          <option value="draft" {{ 'selected' if initial.status=='draft' else '' }}>draft</option>
          <option value="published" {{ 'selected' if initial.status=='published' else '' }}>published</option>
          <option value="archived" {{ 'selected' if initial.status=='archived' else '' }}>archived</option>
        </select>
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Data (JSON)</label>
      <textarea class="form-control" name="data_json" rows="18" spellcheck="false">{{ initial.data }}</textarea>
      <div class="form-text">Pega aqu√≠ el JSON del entry. Debe validar contra el schema activo.</div>
    </div>

    <div class="d-flex gap-2">
      <button class="btn btn-primary" type="submit">Guardar</button>
      <a class="btn btn-secondary" href="/admin/entries">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
