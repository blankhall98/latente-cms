<!-- app/templates/admin/tenants_list.html -->
{% extends "base.html" %}
{% block title %}Proyectos · Latente CMS{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <div class="z2h-brand--badge mb-1">Proyectos</div>
      <h1 class="h4 m-0">Proyectos disponibles</h1>
      <div class="text-muted small">Selecciona un proyecto para administrar su contenido.</div>
    </div>
  </div>

  {% if msg %}<div class="alert alert-success">{{ msg }}</div>{% endif %}
  {% if err %}<div class="alert alert-danger">{{ err }}</div>{% endif %}

  {% if tenants_ctx and tenants_ctx|length > 0 %}
    <div class="row g-3">
      {% for t in tenants_ctx %}
        <div class="col-12 col-md-6">
          <div class="card z2h-card p-3 h-100">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <div class="h5 m-0">{{ t.name or t.slug }}</div>
                <div class="text-muted small">slug: <code>{{ t.slug }}</code> · id: {{ t.id }}</div>
              </div>
              <span class="badge z2h-badge">Proyecto</span>
            </div>

            <div class="z2h-divider my-3"></div>

            <div class="d-flex flex-wrap gap-2">
              <form method="post" action="/admin/switch-tenant">
                <input type="hidden" name="tenant_id" value="{{ t.id }}"/>
                <button class="btn btn-sm btn-primary" type="submit">Entrar</button>
              </form>

              <a class="btn btn-sm btn-outline" href="/admin/sections?tenant_id={{ t.id }}">Secciones</a>
              <a class="btn btn-sm btn-outline" href="/admin/entries?tenant_id={{ t.id }}">Entries</a>
              <!-- JSON utilitario para consumir en GUI dinámicas -->
              <a class="btn btn-sm btn-outline" href="/admin/tenants/{{ t.id }}/sections.json" target="_blank" rel="noopener">Sections.json</a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="text-muted">No tienes proyectos asignados.</div>
  {% endif %}
</div>
{% endblock %}


